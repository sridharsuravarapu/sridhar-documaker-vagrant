---

logoutput:                &logoutput                true
orawls::weblogic::log_output:   *logoutput

wls_os_user:              &wls_os_user              "wls"
wls_weblogic_user:        &wls_weblogic_user        "weblogic"
wls_weblogic_home_dir:    &wls_weblogic_home_dir    "/opt/oracle/middleware11g/wlserver_10.3"
wls_middleware_home_dir:  &wls_middleware_home_dir  "/opt/oracle/middleware11g"


# when you have just one domain on a server
domain_name:                &domain_name                "Wls1036"
domain_adminserver:         &domain_adminserver         "AdminServer"
domain_adminserver_address: &domain_adminserver_address "10.10.10.10"
domain_adminserver_port:    &domain_adminserver_port    7001
domain_nodemanager_port:    &domain_nodemanager_port    5556
domain_wls_password:        &domain_wls_password        "weblogic1"
domain_user_config_file:    "/home/wls/wls-Wls1036-WebLogicConfig.properties"
domain_user_key_file:       "/home/wls/wls-Wls1036-WebLogicKey.properties"


orautils::osDomainParam:          *domain_name
orautils::osDomainPathParam:      "/opt/oracle/wlsdomains/domains/Wls1036"
orautils::nodeMgrAddressParam:    *domain_adminserver_address
orautils::wlsPasswordParam:       *domain_wls_password
orautils::wlsAdminServerParam:    *domain_adminserver

# custom trust
orautils::customTrust:             true
orautils::trustKeystoreFile:       '/vagrant/truststore.jks'
orautils::trustKeystorePassphrase: 'welcome'

# used by nodemanager, control and domain creation
wls_custom_trust:                  &wls_custom_trust              true
wls_trust_keystore_file:           &wls_trust_keystore_file       '/vagrant/truststore.jks'
wls_trust_keystore_passphrase:     &wls_trust_keystore_passphrase 'welcome'

# create a standard domain with custom identity for the adminserver
domain_instances:
  'Wls1036':
    domain_template:                       "standard"
    development_mode:                      false
    log_output:                            *logoutput
    custom_identity:                       true
    custom_identity_keystore_filename:     '/vagrant/identity_admin.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'admin'
    custom_identity_privatekey_passphrase: 'welcome'

wls_setting_instances:
  'default':
    user:               *wls_os_user
    weblogic_home_dir:  *wls_weblogic_home_dir
    connect_url:        "t3://10.10.10.10:7001"
    weblogic_user:      *wls_weblogic_user
    weblogic_password:  *domain_wls_password

# FMW installation on top of WebLogic 10.3.6
fmw_installations:
  # 'soaPS6':
  #   fmw_product:             "soa"
  #   fmw_file1:               "ofm_soa_generic_11.1.1.7.0_disk1_1of2.zip"
  #   fmw_file2:               "ofm_soa_generic_11.1.1.7.0_disk1_2of2.zip"
  #   log_output:              true
  #   remote_file:             false
  # 'webTierPS6':
  #   fmw_product:             "web"
  #   fmw_file1:               "ofm_webtier_linux_11.1.1.7.0_64_disk1_1of1.zip"
  #   log_output:              true
  #   remote_file:             false
  # 'osbPS6':
  #   fmw_product:             "osb"
  #   fmw_file1:               "ofm_osb_generic_11.1.1.7.0_disk1_1of1.zip"
  #   log_output:              true
  #   remote_file:             false

opatch_instances:
  # '17584181':
  #    ensure:                   "present"
  #    oracle_product_home_dir:  "/opt/oracle/middleware11g/Oracle_SOA1"
  #    patch_id:                 "17584181"
  #    patch_file:               "p17584181_111170_Generic.zip"
  #    remote_file:              false

# pack domains
pack_domain_instances:
  'wlsDomain':
    log_output:           *logoutput

# create and startup the nodemanager
nodemanager_instances:
  'nodemanager':
    log_output:                            *logoutput
    custom_identity:                       true
    custom_identity_keystore_filename:     '/vagrant/identity_admin.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'admin'
    custom_identity_privatekey_passphrase: 'welcome'
    nodemanager_address:                   *domain_adminserver_address

# startup adminserver for extra configuration
control_instances:
  'startWLSAdminServer':
     domain_name:          *domain_name
     server_type:          'admin'
     target:               'Server'
     server:               *domain_adminserver
     action:               'start'
     log_output:           *logoutput


authentication_provider_instances:
  'DefaultAuthenticator':
    ensure:             'present'
    control_flag:       'SUFFICIENT'
    order:              '0'
    before:             Wls_domain[Wls1036]
  # 'ldap':
  #   ensure:             'present'
  #   control_flag:       'SUFFICIENT'
  #   providerclassname:  'weblogic.security.providers.authentication.LDAPAuthenticator'
  #   attributes:         'Principal;Host;Port;CacheTTL;CacheSize;MaxGroupMembershipSearchLevel;SSLEnabled'
  #   attributesvalues:   'ldapuser;ldapserver;389;60;1024;4;1'
  #   order:              '1'
  #   before:             Wls_domain[Wls1036]


# this will change some domain parameters and will not create or destroy a new domain
# use orawls::domain to create a new domain
wls_domain_instances:
  'Wls1036':
    ensure:                      'present'
    jpa_default_provider:        'org.eclipse.persistence.jpa.PersistenceProvider'
    jta_max_transactions:        '20000'
    jta_transaction_timeout:     '35'
    log_file_min_size:           '5000'
    log_filecount:               '10'
    log_filename:                '/var/log/weblogic/Wls1036.log'
    log_number_of_files_limited: '1'
    log_rotate_logon_startup:    '1'
    log_rotationtype:            'bySize'
    security_crossdomain:        '0'

# subscribe on a domain change and restart the adminserver
wls_adminserver_instances_domain:
  'AdminServer_Wls1036':
    ensure:                    'running'
    server_name:               *domain_adminserver
    domain_name:               *domain_name
    domain_path:               "/opt/oracle/wlsdomains/domains/Wls1036"
    os_user:                   *wls_os_user
    weblogic_home_dir:         *wls_weblogic_home_dir
    weblogic_user:             *wls_weblogic_user
    weblogic_password:         *domain_wls_password
    jdk_home_dir:              '/usr/java/latest'
    nodemanager_address:       *domain_adminserver_address
    nodemanager_port:          *domain_nodemanager_port
    jsse_enabled:              true
    custom_trust:              *wls_custom_trust
    trust_keystore_file:       *wls_trust_keystore_file
    trust_keystore_passphrase: *wls_trust_keystore_passphrase
    refreshonly:               true
    subscribe:                 Wls_domain[Wls1036]

user_instances:
  'testuser1':
    ensure:                 'present'
    password:               'weblogic1'
    authenticationprovider: 'DefaultAuthenticator'
    realm:                  'myrealm'
    description:            'my test user'
  'testuser2':
    ensure:                 'present'
    password:               'weblogic1'
    authenticationprovider: 'DefaultAuthenticator'
    realm:                  'myrealm'
    description:            'my test user'
  'testuser3':
    ensure:                 'present'
    password:               'weblogic1'
    authenticationprovider: 'DefaultAuthenticator'
    realm:                  'myrealm'
    description:            'my test user'

group_instances:
  'TestGroup':
    ensure:                 'present'
    authenticationprovider: 'DefaultAuthenticator'
    description:            'My TestGroup'
    realm:                  'myrealm'
    users:
      - 'testuser1'
      - 'testuser2'
    require:
      - Wls_user[testuser1]
      - Wls_user[testuser2]
  'SuperUsers':
    ensure:                 'present'
    authenticationprovider: 'DefaultAuthenticator'
    description:            'SuperUsers'
    realm:                  'myrealm'
    users:
      - 'testuser2'
    require:
      - Wls_user[testuser2]

deployment_instances:
  # 'jersey-bundle':
  #   ensure:            'present'
  #   deploymenttype:    'Library'
  #   versionidentifier: '1.18@1.18.0.0'
  #   timeout:           60
  #   target:
  #     - 'AdminServer'
  #     - 'WebCluster'
  #   targettype:
  #     - 'Server'
  #     - 'Cluster'
  #   localpath:         '/vagrant/jersey-bundle-1.18.war'
  #   require:
  #     - Wls_cluster[WebCluster]
  # 'webapp':
  #   ensure:            'present'
  #   deploymenttype:    'AppDeployment'
  #   versionidentifier: '1.1@1.1.0.0'
  #   timeout:           60
  #   target:
  #     - 'WebCluster'
  #   targettype:
  #     - 'Cluster'
  #   localpath:         '/vagrant/webapp.war'
  #   require:
  #     - Wls_deployment[jersey-bundle]
  #     - Wls_cluster[WebCluster]


# create 2 machines
machines_instances:
  'LocalMachine':
    ensure:         'present'
    listenaddress:  '10.10.10.10'
    listenport:     '5556'
    machinetype:    'UnixMachine'
    nmtype:         'SSL'
  'Node1':
    ensure:         'present'
    listenaddress:  '10.10.10.100'
    listenport:     '5556'
    machinetype:    'UnixMachine'
    nmtype:         'SSL'
  'Node2':
    ensure:         'present'
    listenaddress:  '10.10.10.200'
    listenport:     '5556'
    machinetype:    'UnixMachine'
    nmtype:         'SSL'


server_vm_args_permsize:      &server_vm_args_permsize     '-XX:PermSize=256m'
server_vm_args_max_permsize:  &server_vm_args_max_permsize '-XX:MaxPermSize=256m'
server_vm_args_memory:        &server_vm_args_memory       '-Xms752m'
server_vm_args_max_memory:    &server_vm_args_max_memory   '-Xmx752m'

server_instances:
  'AdminServer':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/AdminServer.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/AdminServer_err.out'
    listenaddress:                         '10.10.10.10'
    listenport:                            '7001'
    machine:                               'LocalMachine'
    logfilename:                           '/var/log/weblogic/AdminServer.log'
    log_datasource_filename:               '/var/log/weblogic/AdminServer_datasource.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    log_http_filename:                     '/var/log/weblogic/AdminServer_access.log'
    log_http_format_type:                  'extended'
    log_http_format:                       'date time x-XForwardedFor s-ip cs-method cs-uri x-SOAPAction sc-status bytes time-taken x-UserAgent'
    tunnelingenabled:                      '0'
    max_message_size:                      '10000000'
    sslenabled:                            '0'
    ssllistenport:                         '7002'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_admin.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'admin'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    require:
      - Wls_machine[LocalMachine]
  'wlsServer1':
    ensure:                                'absent'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/wlsServer1.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/wlsServer1_err.out'
    listenaddress:                         '10.10.10.100'
    listenport:                            '8001'
    logfilename:                           '/var/log/weblogic/wlsServer1.log'
    log_datasource_filename:               '/var/log/weblogic/wlsServer1_datasource.log'
    log_http_filename:                     '/var/log/weblogic/wlsServer1_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node1'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node1.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node1'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node1]

  'ms-oc-cor1-dmk11':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/v-oc-cor1-dmk11.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/v-oc-cor1-dmk11_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk11
    listenport:                            '10001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-dmk11.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-dmk11_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-dmk11_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node1'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node1.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node1'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node1]

  'ms-oc-cor1-idm11':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-idm11.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-idm11_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk11
    listenport:                            '9001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-idm11.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-idm11_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-idm11_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node1'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node1.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node1'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node1]

  'ms-oc-cor1-soa11':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-soa11.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-soa11_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk11
    listenport:                            '8001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-soa11.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-soa11_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-soa11_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node1'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node1.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node1'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node1]

  'ms-oc-cor1-wsm11':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-wsm11.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-wsm11_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk11
    listenport:                            '7010'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-wsm11.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-wsm11_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-wsm11_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node1'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node1.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node1'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node1]

  'ms-oc-cor1-jms11':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-jms11.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-jms11_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk11
    listenport:                            '11001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-jms11.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-jms11_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-jms11_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node1'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node1.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node1'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node1]

  'wlsServer2':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/wlsServer2.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/wlsServer2_err.out'
    listenport:                            '8001'
    logfilename:                           '/var/log/weblogic/wlsServer2.log'
    log_datasource_filename:               '/var/log/weblogic/wlsServer2_datasource.log'
    log_http_filename:                     '/var/log/weblogic/wlsServer2_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node2'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    listenaddress:                         '10.10.10.200'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_node2.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'node2'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node2]

  'ms-oc-cor1-dmk12':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/v-oc-cor1-dmk12.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/v-oc-cor1-dmk12_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk12
    listenport:                            '10001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-dmk12.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-dmk12_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-dmk12_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node2'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_Node2.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'Node2'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node2]

  'ms-oc-cor1-idm12':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-idm12.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-idm12_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk12
    listenport:                            '9001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-idm12.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-idm12_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-idm12_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node2'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_Node2.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'Node2'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node2]

  'ms-oc-cor1-soa12':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-soa12.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-soa12_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk12
    listenport:                            '8001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-soa12.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-soa12_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-soa12_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node2'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_Node2.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'Node2'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node2]

  'ms-oc-cor1-wsm12':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-wsm12.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-wsm12_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk12
    listenport:                            '7010'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-wsm12.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-wsm12_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-wsm12_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node2'
    sslenabled:                            '1'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_Node2.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'Node2'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node2]

  'ms-oc-cor1-jms12':
    ensure:                                'present'
    arguments:
           - *server_vm_args_permsize
           - *server_vm_args_max_permsize
           - *server_vm_args_memory
           - *server_vm_args_max_memory
           - '-Dweblogic.Stdout=/var/log/weblogic/ms-oc-cor1-jms12.out'
           - '-Dweblogic.Stderr=/var/log/weblogic/ms-oc-cor1-jms12_err.out'
    listenaddress:                         '10.10.10.100' #v-oc-cor1-dmk12
    listenport:                            '11001'
    logfilename:                           '/var/log/weblogic/ms-oc-cor1-jms12.log'
    log_datasource_filename:               '/var/log/weblogic/ms-oc-cor1-jms12_datasource.log'
    log_http_filename:                     '/var/log/weblogic/ms-oc-cor1-jms12_access.log'
    log_file_min_size:                     '2000'
    log_filecount:                         '10'
    log_number_of_files_limited:           '1'
    log_rotate_logon_startup:              '1'
    log_rotationtype:                      'bySize'
    machine:                               'Node2'
    sslenabled:                            '0'
    ssllistenport:                         '8201'
    sslhostnameverificationignored:        '1'
    two_way_ssl:                           '0'
    client_certificate_enforced:           '0'
    jsseenabled:                           '1'
    custom_identity:                       '1'
    custom_identity_keystore_filename:     '/vagrant/identity_Node2.jks'
    custom_identity_keystore_passphrase:   'welcome'
    custom_identity_alias:                 'Node2'
    custom_identity_privatekey_passphrase: 'welcome'
    trust_keystore_file:                   *wls_trust_keystore_file
    trust_keystore_passphrase:             *wls_trust_keystore_passphrase
    max_message_size:                      '25000000'
    require:
      - Wls_machine[Node2]


# subscribe on a adminserver change and restart the adminserver
wls_adminserver_instances_server:
  'AdminServer_Wls1036_2':
    ensure:                    'running'
    server_name:               *domain_adminserver
    domain_name:               *domain_name
    domain_path:               "/opt/oracle/wlsdomains/domains/Wls1036"
    os_user:                   *wls_os_user
    weblogic_home_dir:         *wls_weblogic_home_dir
    weblogic_user:             *wls_weblogic_user
    weblogic_password:         *domain_wls_password
    jdk_home_dir:              '/usr/java/latest'
    nodemanager_address:       *domain_adminserver_address
    nodemanager_port:          *domain_nodemanager_port
    jsse_enabled:              true
    custom_trust:              *wls_custom_trust
    trust_keystore_file:       *wls_trust_keystore_file
    trust_keystore_passphrase: *wls_trust_keystore_passphrase
    refreshonly:               true
    subscribe:                 Wls_server[AdminServer]


cluster_instances:

  'WebCluster':
    ensure:                     'absent'
    migrationbasis:             'consensus'
    # migrationbasis:             'database'
    # migration_datasource:       'jmsDS'
    # migration_table_name:       'ACTIVE'
    servers:
      - 'wlsServer1'
      - 'wlsServer2'
    # datasourceforjobscheduler:  'jmsDS'
    messagingmode:              'unicast'
    unicastbroadcastchannel:    'Channel-Cluster'
    frontendhost:               '10.10.10.10'
    frontendhttpport:           '2001'
    frontendhttpsport:          '2002'
    require:
      - Wls_server[wlsServer1]
      - Wls_server[wlsServer2]

  'dmk_cluster':
    ensure:                     'present'
    migrationbasis:             'consensus'
    # migrationbasis:             'database'
    # migration_datasource:       'jmsDS'
    # migration_table_name:       'ACTIVE'
    servers:
      - 'ms-oc-cor1-dmk11'
      - 'ms-oc-cor1-dmk12'
    # datasourceforjobscheduler:  'jmsDS'
    messagingmode:              'unicast'
    unicastbroadcastchannel:    'Channel-Cluster'
    frontendhost:               '10.10.10.10'
    frontendhttpport:           '2001'
    frontendhttpsport:          '2002'
    require:
      - Wls_server[ms-oc-cor1-dmk11]
      - Wls_server[ms-oc-cor1-dmk12]

  'idm_cluster':
    ensure:                     'present'
    migrationbasis:             'consensus'
    # migrationbasis:             'database'
    # migration_datasource:       'jmsDS'
    # migration_table_name:       'ACTIVE'
    servers:
      - 'ms-oc-cor1-idm11'
      - 'ms-oc-cor1-idm12'
    # datasourceforjobscheduler:  'jmsDS'
    messagingmode:              'unicast'
    unicastbroadcastchannel:    'Channel-Cluster'
    frontendhost:               '10.10.10.10'
    frontendhttpport:           '2001'
    frontendhttpsport:          '2002'
    require:
      - Wls_server[ms-oc-cor1-idm11]
      - Wls_server[ms-oc-cor1-idm12]

  'soa_cluster':
    ensure:                     'present'
    migrationbasis:             'consensus'
    # migrationbasis:             'database'
    # migration_datasource:       'jmsDS'
    # migration_table_name:       'ACTIVE'
    servers:
      - 'ms-oc-cor1-soa11'
      - 'ms-oc-cor1-soa12'
    # datasourceforjobscheduler:  'jmsDS'
    messagingmode:              'unicast'
    unicastbroadcastchannel:    'Channel-Cluster'
    frontendhost:               '10.10.10.10'
    frontendhttpport:           '2001'
    frontendhttpsport:          '2002'
    require:
      - Wls_server[ms-oc-cor1-soa11]
      - Wls_server[ms-oc-cor1-soa12]


  'wsm_cluster':
    ensure:                     'present'
    migrationbasis:             'consensus'
    # migrationbasis:             'database'
    # migration_datasource:       'jmsDS'
    # migration_table_name:       'ACTIVE'
    servers:
      - 'ms-oc-cor1-wsm11'
      - 'ms-oc-cor1-wsm12'
    # datasourceforjobscheduler:  'jmsDS'
    messagingmode:              'unicast'
    unicastbroadcastchannel:    'Channel-Cluster'
    frontendhost:               '10.10.10.10'
    frontendhttpport:           '2001'
    frontendhttpsport:          '2002'
    require:
      - Wls_server[ms-oc-cor1-wsm11]
      - Wls_server[ms-oc-cor1-wsm12]


datasource_instances:
    'jmsDS':
      ensure:                      'absent'
      drivername:                  'com.mysql.jdbc.Driver'
      globaltransactionsprotocol:  'None'
      initialcapacity:             '0'
      jndinames:
        - 'jmsDS'
      maxcapacity:                 '15'
      target:
        - 'wlsServer1'
        - 'wlsServer2'
      targettype:
        - 'Server'
        - 'Server'
      testtablename:               'SQL SELECT 1'
      url:                         'jdbc:mysql://10.10.10.10:3306/jms'
      user:                        'jms'
      password:                    'jms'
      usexa:                       '1'
      require:
        - Wls_server[wlsServer1]
        - Wls_server[wlsServer2]

file_persistence_folders:
   '/opt/oracle/wlsdomains/domains/Wls1036/persistence1':
      ensure:     directory
      recurse:    false
      replace:    false
      mode:       '0775'
      owner:      'wls'
      group:      'dba'
   '/opt/oracle/wlsdomains/domains/Wls1036/persistence2':
      ensure:     directory
      recurse:    false
      replace:    false
      mode:       '0775'
      owner:      'wls'
      group:      'dba'

file_persistence_store_instances:
  'jmsFile1':
    ensure:         'absent'
    directory:      'persistence1'
    target:
      - 'wlsServer1'
    targettype:
      - 'Server'
    require:
      - Wls_server[wlsServer1]
      - File[/opt/oracle/wlsdomains/domains/Wls1036/persistence1]
  'jmsFile2':
    ensure:         'absent'
    directory:      'persistence2'
    target:
      - 'wlsServer2'
    targettype:
      - 'Server'
    require:
      - Wls_server[wlsServer2]
      - File[/opt/oracle/wlsdomains/domains/Wls1036/persistence2]

jmsserver_instances:
   'jmsServer1':
     ensure:              'absent'
     target:
       - 'wlsServer1'
     targettype:
       - 'Server'
     persistentstore:     'jmsFile1'
     persistentstoretype: 'FileStore'
     require:
       - Wls_server[wlsServer1]
       - Wls_file_persistence_store[jmsFile1]
   'jmsServer2':
     ensure:              'absent'
     target:
       - 'wlsServer2'
     targettype:
       - 'Server'
     require:
       - Wls_server[wlsServer2]

jms_module_instances:
   'jmsClusterModule':
     ensure:      'absent'
     target:
       - 'WebCluster'
     targettype:
       - 'Cluster'
     require:     Wls_cluster[WebCluster]

jms_subdeployment_instances:
   'jmsClusterModule:jmsServers':
      ensure:     'absent'
      target:
        - 'jmsServer1'
        - 'jmsServer2'
      targettype:
        - 'JMSServer'
        - 'JMSServer'
      require:
        - Wls_jms_module[jmsClusterModule]
        - Wls_jmsserver[jmsServer1]
        - Wls_jmsserver[jmsServer2]
   'jmsClusterModule:wlsServers':
      ensure:     'absent'
      target:
        - 'WebCluster'
      targettype:
        - 'Cluster'
      require:
        - Wls_jms_module[jmsClusterModule]
        - Wls_cluster[WebCluster]

jms_connection_factory_instances:
  'jmsClusterModule:cf':
      ensure:             'absent'
      jmsmodule:          'jmsClusterModule'
      defaulttargeting:   '0'
      jndiname:           'jms/cf'
      subdeployment:      'wlsServers'
      transactiontimeout: '3600'
      xaenabled:          '0'
      require:
        - Wls_jms_module[jmsClusterModule]
        - Wls_jms_subdeployment[jmsClusterModule:wlsServers]
  'jmsClusterModule:cf2':
      ensure:             'absent'
      jmsmodule:          'jmsClusterModule'
      defaulttargeting:   '1'
      jndiname:           'jms/cf2'
      transactiontimeout: '3600'
      xaenabled:          '1'
      require:
        - Wls_jms_module[jmsClusterModule]

jms_queue_instances:
   'jmsClusterModule:ErrorQueue':
     ensure:                   'absent'
     distributed:              '1'
     expirationpolicy:         'Discard'
     jndiname:                 'jms/ErrorQueue'
     redeliverydelay:          '-1'
     redeliverylimit:          '-1'
     subdeployment:            'jmsServers'
     defaulttargeting:         '0'
     timetodeliver:            '-1'
     timetolive:               '-1'
     require:
       - Wls_jms_module[jmsClusterModule]
       - Wls_jms_subdeployment[jmsClusterModule:jmsServers]
   'jmsClusterModule:Queue1':
     ensure:                   'absent'
     distributed:              '1'
     errordestination:         'ErrorQueue'
     expirationpolicy:         'Redirect'
     jndiname:                 'jms/Queue1'
     redeliverydelay:          '2000'
     redeliverylimit:          '3'
     subdeployment:            'jmsServers'
     defaulttargeting:         '0'
     timetodeliver:            '-1'
     timetolive:               '300000'
     require:
       - Wls_jms_module[jmsClusterModule]
       - Wls_jms_subdeployment[jmsClusterModule:jmsServers]
       - Wls_jms_queue[jmsClusterModule:ErrorQueue]
   'jmsClusterModule:Queue2':
     ensure:                   'absent'
     distributed:              '1'
     expirationloggingpolicy:  '%header%%properties%'
     expirationpolicy:         'Log'
     jndiname:                 'jms/Queue2'
     redeliverydelay:          '2000'
     redeliverylimit:          '3'
     subdeployment:            'jmsServers'
     defaulttargeting:         '0'
     timetodeliver:            '-1'
     timetolive:               '300000'
     require:
       - Wls_jms_module[jmsClusterModule]
       - Wls_jms_subdeployment[jmsClusterModule:jmsServers]


jms_topic_instances:
   'jmsClusterModule:Topic1':
     ensure:               'absent'
     defaulttargeting:     '0'
     distributed:          '1'
     expirationpolicy:     'Discard'
     jndiname:             'jms/Topic1'
     redeliverydelay:      '2000'
     redeliverylimit:      '2'
     subdeployment:        'jmsServers'
     timetodeliver:        '-1'
     timetolive:           '300000'
     require:
       - Wls_jms_module[jmsClusterModule]
       - Wls_jms_subdeployment[jmsClusterModule:jmsServers]
   'jmsClusterModule:Topic2':
     ensure:               'absent'
     defaulttargeting:     '0'
     distributed:          '1'
     errordestinationtype: 'UniformDistributedQueues'
     errordestination:     'ErrorQueue'
     expirationpolicy:     'Redirect'
     redeliverydelay:      '2000'
     redeliverylimit:      '3'
     jndiname:             'jms/Topic2'
     subdeployment:        'jmsServers'
     timetodeliver:        '-1'
     timetolive:           '300000'
     require:
       - Wls_jms_module[jmsClusterModule]
       - Wls_jms_subdeployment[jmsClusterModule:jmsServers]
       - Wls_jms_queue[jmsClusterModule:ErrorQueue]

